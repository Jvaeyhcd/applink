/*!
 * applink.js
 *
 * Copyright 2016
 * Released under MIT license
 */
!function(){"use strict";function e(){if(document[o]){if(!c||!l)return;clearInterval(l),l=null,c=!1}}function t(e,t){var n=navigator.userAgent.indexOf("Android")>-1&&navigator.userAgent.indexOf("Mozilla/5.0")>-1&&navigator.userAgent.indexOf("AppleWebKit")>-1,i=/AppleWebKit\/([\d.]+)/,a=i.exec(navigator.userAgent),o=null===a?null:parseFloat(a[1]),d=n&&null!==o&&o>500;return d?"intent:"+t.split(":")[1]+"#Intent;scheme="+t.split(":")[0]+";S.browser_fallback_url="+encodeURI(e):t}function n(e){window.location.href=e}function i(){document.body.addEventListener("click",function(e){var i,a=e.target,o=a.getAttribute("data-deeplink");"a"!==a.tagName||!o||c||l||(e.preventDefault(),e.stopImmediatePropagation(),i=Date.now(),c=!0,l=setTimeout(function(){c&&l&&(c=!1,l=null,Date.now()-i>=2*u||n(a.href))},u),n(t(a.href,o)))},!1)}function a(e){if(e){var t=e.getAttribute("data-href-"+r);t&&(e.href=t)}}var o,d,r="",u=1200,c=!1,l=null;!function(){var e=navigator.userAgent;r=e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?"ios":"android",(/\bMicroMessenger\b/i.test(e)||/\bQQ\b/i.test(e))&&(r="qq-"+r)}(),function(){void 0!==document.hidden?(o="hidden",d="visibilitychange"):void 0!==document.msHidden?(o="msHidden",d="msvisibilitychange"):void 0!==document.webkitHidden&&(o="webkitHidden",d="webkitvisibilitychange")}(),window.applink={init:function(){var t,n=document.getElementsByTagName("a");for(t=n.length-1;t>=0;t-=0)a(n[t]);i(),void 0!==document[o]&&document.addEventListener(d,e,!1)},optimize:a}}();